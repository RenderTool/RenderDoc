"use strict";(self.webpackChunkrenderdoc=self.webpackChunkrenderdoc||[]).push([[7555],{26864:(n,s,a)=>{a.r(s),a.d(s,{comp:()=>j,data:()=>_});var e=a(20641);const t=(0,e.Lk)("h2",{id:"前言",tabindex:"-1"},[(0,e.Lk)("a",{class:"header-anchor",href:"#前言"},[(0,e.Lk)("span",null,"前言")])],-1),o={href:"https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y/edit#heading=h.greljkmo14y0",target:"_blank",rel:"noopener noreferrer"},i=(0,e.Fv)('<h2 id="规范-commit" tabindex="-1"><a class="header-anchor" href="#规范-commit"><span>规范(commit)</span></a></h2><p>Commit message 包括三个部分：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token operator">&lt;</span>type<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>scope<span class="token operator">&gt;</span><span class="token punctuation">)</span>: <span class="token operator">&lt;</span>subject<span class="token operator">&gt;</span> <span class="token comment"># 必填</span>\n<span class="token operator">&lt;</span>BLANK LINE<span class="token operator">&gt;</span> <span class="token comment"># 空一行</span>\n<span class="token operator">&lt;</span>body<span class="token operator">&gt;</span> <span class="token comment"># 可选</span>\n<span class="token operator">&lt;</span>BLANK LINE<span class="token operator">&gt;</span> <span class="token comment"># 空一行</span>\n<span class="token operator">&lt;</span>footer<span class="token operator">&gt;</span> <span class="token comment"># 可选</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>type：必填，<code>commit</code> 的类型</p><ul><li>feat：新功能</li><li>fix：修复 bug</li><li>docs：文档修改</li><li>style：格式修改，例如空格、分号等</li><li>refactor：不增加功能也不修复 bug 的代码更改</li><li>perf：性能提升、交互优化</li><li>test：测试相关修改</li><li>build：外部依赖项的修改，如 gulp、npm</li><li>ci：ci 的修改</li><li>chore：关于构建项目相关的修改，非代码和测试</li><li>revert：版本回滚</li></ul></li><li><p>scope：选填，<code>commit</code> 的影响范围，常指定模块或文件名</p></li><li><p>subject：必填，<code>commit</code> 的简短描述</p></li><li><p>body：选填，<code>commit</code> 的详细描述</p></li><li><p>footer：选填，备注信息，通常是破坏性更新或关闭 Issue</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>BREAKING CHANGE: 变动的描述\nClose <span class="token comment">#ISSUE_ID</span>\nCloses <span class="token comment">#ISSUE_ID, #ISSUE_ID</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="_1-模板" tabindex="-1"><a class="header-anchor" href="#_1-模板"><span>1. 模板</span></a></h3>',5),l={href:"https://www.npmjs.com/package/commitizen",target:"_blank",rel:"noopener noreferrer"},p=(0,e.Fv)('<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i commitizen <span class="token parameter variable">-D</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>初始化适配器：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>npx commitizen init cz-conventional-changelog <span class="token parameter variable">--yarn</span> <span class="token parameter variable">--dev</span> <span class="token parameter variable">--exact</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>在 <code>package.json</code> 中添加 <code>script</code>：</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>\n  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">&quot;commit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cz&quot;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;config&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">&quot;commitizen&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cz-conventional-changelog&quot;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当执行 <code>yarn run commit</code> 就可以使用提交模板了。</p><h3 id="_2-强制规范" tabindex="-1"><a class="header-anchor" href="#_2-强制规范"><span>2. 强制规范</span></a></h3>',7),c={href:"https://github.com/conventional-changelog/commitlint#readme",target:"_blank",rel:"noopener noreferrer"},r=(0,e.Lk)("strong",null,"husky v5",-1),d={href:"https://typicode.github.io/husky/#/?id=migrate-from-v4-to-v6",target:"_blank",rel:"noopener noreferrer"},u=(0,e.Fv)('<p><strong>如何校验：</strong></p><ul><li><p>安装依赖</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i @commitlint/cli @commitlint/config-conventional <span class="token parameter variable">-D</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>指定校验模板</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;module.exports = {extends: [&#39;@commitlint/config-conventional&#39;]}&quot;</span> <span class="token operator">&gt;</span> commitlint.config.js\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul><p><strong>何时校验：</strong></p><p>很明显需要在 <code>git commit</code> 前的生命周期内进行校验。</p><ul><li><p>安装 husky</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i husky <span class="token parameter variable">-D</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>拦截 git hook</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># Active hooks</span>\nnpx husky <span class="token function">install</span>\n\n<span class="token comment"># Add hook</span>\nnpx husky <span class="token function">add</span> .husky/commit-msg <span class="token string">&quot;npx --no-install commitlint --edit <span class="token variable">$1</span>&quot;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>测试</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span>\n<span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">&quot;hello husky&quot;</span>\n\n<span class="token comment"># 拦截</span>\n⧗   input: hello husky\n✖   subject may not be empty <span class="token punctuation">[</span>subject-empty<span class="token punctuation">]</span>\n✖   <span class="token builtin class-name">type</span> may not be empty <span class="token punctuation">[</span>type-empty<span class="token punctuation">]</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="生成-changelog-日志" tabindex="-1"><a class="header-anchor" href="#生成-changelog-日志"><span>生成 (CHANGELOG)日志</span></a></h2><p>根据规则生成 CHANGELOG 的前提是 commit 规范化。</p>',7),m={href:"https://github.com/conventional-changelog/standard-version",target:"_blank",rel:"noopener noreferrer"},v=(0,e.Fv)('<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i standard-version <span class="token parameter variable">-D</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>在 <code>package.json</code> 中添加 <code>script</code>：</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>\n  <span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">&quot;changelog&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standard-version&quot;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行 <code>npm run release</code> 得到的效果一般，那么自然希望加点料。</p><h3 id="_1-配置" tabindex="-1"><a class="header-anchor" href="#_1-配置"><span>1. 配置</span></a></h3>',5),g={href:"https://github.com/conventional-changelog/conventional-changelog-config-spec/blob/master/versions/2.1.0/README.md",target:"_blank",rel:"noopener noreferrer"},k=(0,e.Lk)("code",null,".versionrc.js",-1),h=(0,e.Fv)('<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token string-property property">&quot;header&quot;</span><span class="token operator">:</span> <span class="token string">&quot;# CHANGELOG\\n\\n这是一个有趣的 CHANGELOG。\\n\\n&quot;</span><span class="token punctuation">,</span>\n  <span class="token string-property property">&quot;types&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">{</span> <span class="token string-property property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;feat&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;section&quot;</span><span class="token operator">:</span> <span class="token string">&quot;✨ Features | 新功能&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">{</span> <span class="token string-property property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;fix&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;section&quot;</span><span class="token operator">:</span> <span class="token string">&quot;🐛 Fixes | Bug 修复&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">{</span> <span class="token string-property property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;perf&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;section&quot;</span><span class="token operator">:</span> <span class="token string">&quot;🔥 Performance Improvements | 性能优化&quot;</span> <span class="token punctuation">}</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-指定版本" tabindex="-1"><a class="header-anchor" href="#_2-指定版本"><span>2. 指定版本</span></a></h3><p>npm 命令传参需要使用 <code>--</code>：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> run changelog -- --release-as <span class="token number">1.6</span>.0\n<span class="token comment"># 或</span>\n<span class="token function">npm</span> run changelog -- <span class="token parameter variable">-r</span> minor\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-hash-链接" tabindex="-1"><a class="header-anchor" href="#_3-hash-链接"><span>3. hash 链接</span></a></h3><p>这需要为项目添加 <code>git remote</code> 地址：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">git</span> remote <span class="token function">add</span> origin git@github.com:yourname/project.git\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="代码校验" tabindex="-1"><a class="header-anchor" href="#代码校验"><span>代码校验</span></a></h2><p>前面已经打好了铺垫，加上代码校验也是顺理成章的事情。</p>',9),b={href:"https://www.npmjs.com/package/lint-staged",target:"_blank",rel:"noopener noreferrer"},y=(0,e.Fv)('<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> i lint-staged <span class="token parameter variable">-D</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>接着前往 <code>package.json</code> 增加 <code>lint-staged</code> 字段，以 vue-cli 创建的项目示例：</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code>\n  <span class="token property">&quot;lint-staged&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">&quot;*.{js,jsx,vue,ts,tsx}&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token string">&quot;vue-cli-service lint&quot;</span><span class="token punctuation">,</span>\n      <span class="token string">&quot;git add&quot;</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span>\n\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>而 husky 校验同样不在 <code>package.json</code> 中设置了：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>npx husky <span class="token function">add</span> .husky/pre-commit <span class="token string">&quot;npx --no-install lint-staged&quot;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>',5),f={href:"https://github.com/stylelint/stylelint",target:"_blank",rel:"noopener noreferrer"},q=(0,e.Lk)("h2",{id:"参考资料",tabindex:"-1"},[(0,e.Lk)("a",{class:"header-anchor",href:"#参考资料"},[(0,e.Lk)("span",null,"参考资料")])],-1),x={href:"https://juejin.cn/post/7138790324494827533",target:"_blank",rel:"noopener noreferrer"},L={},j=(0,a(66262).A)(L,[["render",function(n,s){const a=(0,e.g2)("ExternalLinkIcon"),L=(0,e.g2)("chatmessage");return(0,e.uX)(),(0,e.CE)("div",null,[t,(0,e.Lk)("p",null,[(0,e.eW)("规范的 commit message 有助于团队其它人员 review"),(0,e.Lk)("a",o,[(0,e.eW)("Angular 规范"),(0,e.bF)(a)]),(0,e.eW)("。")]),i,(0,e.bF)(L,{avatar:"../../assets/emoji/blzt.png",avatarWidth:40},{default:(0,e.k6)((()=>[(0,e.eW)(" 对不起我是真记不住。 ")])),_:1}),(0,e.Lk)("p",null,[(0,e.eW)("提交信息最好在在"),(0,e.Lk)("a",l,[(0,e.eW)("模板"),(0,e.bF)(a)]),(0,e.eW)("的约束下：")]),p,(0,e.Lk)("p",null,[(0,e.eW)("为了在各种姿势使 commit 符合规范，"),(0,e.Lk)("a",c,[(0,e.eW)("校验"),(0,e.bF)(a)]),(0,e.eW)("是必要的。注意 "),r,(0,e.eW)(" 配置有所"),(0,e.Lk)("a",d,[(0,e.eW)("更改"),(0,e.bF)(a)]),(0,e.eW)("。")]),u,(0,e.Lk)("p",null,[(0,e.eW)("首先安装"),(0,e.Lk)("a",m,[(0,e.eW)("依赖"),(0,e.bF)(a)]),(0,e.eW)("，如果之前使用了其他模板，也应寻找对应的依赖。")]),v,(0,e.Lk)("p",null,[(0,e.eW)("新增 "),(0,e.Lk)("a",g,[k,(0,e.bF)(a)]),(0,e.eW)(" 文件：")]),h,(0,e.Lk)("p",null,[(0,e.eW)("一般代码校验只希望"),(0,e.Lk)("a",b,[(0,e.eW)("校验更新的文件"),(0,e.bF)(a)]),(0,e.eW)("：")]),y,(0,e.Lk)("p",null,[(0,e.eW)("如果还想加些什么，可以手动追加，例如 "),(0,e.Lk)("a",f,[(0,e.eW)("stylelint"),(0,e.bF)(a)]),(0,e.eW)("。")]),q,(0,e.Lk)("p",null,[(0,e.Lk)("a",x,[(0,e.eW)("Git Commit规范指北"),(0,e.bF)(a)])])])}]]),_=JSON.parse('{"path":"/tools/git/3-commit-message.html","title":"Git-3.规范 Git 提交信息并生成日志","lang":"zh-CN","frontmatter":{"title":"Git-3.规范 Git 提交信息并生成日志","order":3,"category":["Git"],"tag":["husky"],"description":"前言 规范的 commit message 有助于团队其它人员 reviewAngular 规范。 规范(commit) Commit message 包括三个部分： type：必填，commit 的类型 feat：新功能 fix：修复 bug docs：文档修改 style：格式修改，例如空格、分号等 refactor：不增加功能也不修复 bug 的...","head":[["meta",{"property":"og:url","content":"https://rendertool.github.io/RenderDoc/RenderDoc/tools/git/3-commit-message.html"}],["meta",{"property":"og:site_name","content":"RenderDoc"}],["meta",{"property":"og:title","content":"Git-3.规范 Git 提交信息并生成日志"}],["meta",{"property":"og:description","content":"前言 规范的 commit message 有助于团队其它人员 reviewAngular 规范。 规范(commit) Commit message 包括三个部分： type：必填，commit 的类型 feat：新功能 fix：修复 bug docs：文档修改 style：格式修改，例如空格、分号等 refactor：不增加功能也不修复 bug 的..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-01-02T22:07:13.000Z"}],["meta",{"property":"article:author","content":"Mr.Si"}],["meta",{"property":"article:tag","content":"husky"}],["meta",{"property":"article:modified_time","content":"2024-01-02T22:07:13.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Git-3.规范 Git 提交信息并生成日志\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-01-02T22:07:13.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mr.Si\\",\\"url\\":\\"https://rendertool.github.io/RenderDoc/\\"}]}"]]},"headers":[{"level":2,"title":"前言","slug":"前言","link":"#前言","children":[]},{"level":2,"title":"规范(commit)","slug":"规范-commit","link":"#规范-commit","children":[{"level":3,"title":"1. 模板","slug":"_1-模板","link":"#_1-模板","children":[]},{"level":3,"title":"2. 强制规范","slug":"_2-强制规范","link":"#_2-强制规范","children":[]}]},{"level":2,"title":"生成 (CHANGELOG)日志","slug":"生成-changelog-日志","link":"#生成-changelog-日志","children":[{"level":3,"title":"1. 配置","slug":"_1-配置","link":"#_1-配置","children":[]},{"level":3,"title":"2. 指定版本","slug":"_2-指定版本","link":"#_2-指定版本","children":[]},{"level":3,"title":"3. hash 链接","slug":"_3-hash-链接","link":"#_3-hash-链接","children":[]}]},{"level":2,"title":"代码校验","slug":"代码校验","link":"#代码校验","children":[]},{"level":2,"title":"参考资料","slug":"参考资料","link":"#参考资料","children":[]}],"git":{"createdTime":1698994095000,"updatedTime":1704233233000,"contributors":[{"name":"admin","email":"750831855@qq.com","commits":6},{"name":"sigaohe","email":"750831855@qq.com","commits":1}]},"readingTime":{"minutes":2.77,"words":832},"filePathRelative":"tools/git/3-commit-message.md","localizedDate":"2023年11月3日","excerpt":"<h2>前言</h2>\\n<p>规范的 commit message 有助于团队其它人员 review<a href=\\"https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y/edit#heading=h.greljkmo14y0\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Angular 规范</a>。</p>\\n<h2>规范(commit)</h2>\\n<p>Commit message 包括三个部分：</p>\\n<div class=\\"language-bash\\" data-ext=\\"sh\\" data-title=\\"sh\\"><pre class=\\"language-bash\\"><code><span class=\\"token operator\\">&lt;</span>type<span class=\\"token operator\\">&gt;</span><span class=\\"token punctuation\\">(</span><span class=\\"token operator\\">&lt;</span>scope<span class=\\"token operator\\">&gt;</span><span class=\\"token punctuation\\">)</span>: <span class=\\"token operator\\">&lt;</span>subject<span class=\\"token operator\\">&gt;</span> <span class=\\"token comment\\"># 必填</span>\\n<span class=\\"token operator\\">&lt;</span>BLANK LINE<span class=\\"token operator\\">&gt;</span> <span class=\\"token comment\\"># 空一行</span>\\n<span class=\\"token operator\\">&lt;</span>body<span class=\\"token operator\\">&gt;</span> <span class=\\"token comment\\"># 可选</span>\\n<span class=\\"token operator\\">&lt;</span>BLANK LINE<span class=\\"token operator\\">&gt;</span> <span class=\\"token comment\\"># 空一行</span>\\n<span class=\\"token operator\\">&lt;</span>footer<span class=\\"token operator\\">&gt;</span> <span class=\\"token comment\\"># 可选</span>\\n</code></pre></div>","autoDesc":true}')}}]);