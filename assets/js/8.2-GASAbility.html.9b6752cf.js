"use strict";(self.webpackChunkrenderdoc=self.webpackChunkrenderdoc||[]).push([[8114],{80136:(n,a,s)=>{s.r(a),s.d(a,{comp:()=>R,data:()=>O});var t=s(20641);const e=s.p+"assets/img/GA_001.533590aa.jpg",o=s.p+"assets/img/GA_002.e6ee89ff.png",i=s.p+"assets/img/GA_004.ef42d413.png",c=s.p+"assets/img/GA_003.ef72c01e.png",l=s.p+"assets/img/GA_005.c2954ac3.jpg",p=s.p+"assets/img/GA_007.5725bf3f.png",k=s.p+"assets/img/GA_006.95041df2.png",u=s.p+"assets/img/GA_008.00b382b6.png",r=s.p+"assets/img/GA_009.997dcf8c.png",L=s.p+"assets/img/GA_010.2273eab4.png",d=(0,t.Lk)("h2",{id:"回顾",tabindex:"-1"},[(0,t.Lk)("a",{class:"header-anchor",href:"#回顾"},[(0,t.Lk)("span",null,"回顾")])],-1),b=(0,t.Lk)("h3",{id:"网络权限",tabindex:"-1"},[(0,t.Lk)("a",{class:"header-anchor",href:"#网络权限"},[(0,t.Lk)("span",null,"网络权限")])],-1),m=(0,t.Lk)("figure",null,[(0,t.Lk)("img",{src:e,alt:"",tabindex:"0",loading:"lazy"}),(0,t.Lk)("figcaption")],-1),v=(0,t.Lk)("figure",null,[(0,t.Lk)("img",{src:o,alt:"",tabindex:"0",loading:"lazy"}),(0,t.Lk)("figcaption")],-1),y=(0,t.Lk)("h3",{id:"giveability",tabindex:"-1"},[(0,t.Lk)("a",{class:"header-anchor",href:"#giveability"},[(0,t.Lk)("span",null,"GiveAbility")])],-1),W=(0,t.Fv)('<figure><img src="'+i+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="language-cpp line-numbers-mode" data-ext="cpp" data-title="cpp"><pre class="language-cpp"><code>\t<span class="token function">UFUNCTION</span><span class="token punctuation">(</span>BlueprintCallable<span class="token punctuation">,</span> BlueprintAuthorityOnly<span class="token punctuation">,</span> Category <span class="token operator">=</span> <span class="token string">&quot;Gameplay Abilities&quot;</span><span class="token punctuation">,</span> meta <span class="token operator">=</span> <span class="token punctuation">(</span>DisplayName <span class="token operator">=</span> <span class="token string">&quot;Give Ability&quot;</span><span class="token punctuation">,</span> ScriptName <span class="token operator">=</span> <span class="token string">&quot;GiveAbility&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\tFGameplayAbilitySpecHandle <span class="token function">K2_GiveAbility</span><span class="token punctuation">(</span>TSubclassOf<span class="token operator">&lt;</span>UGameplayAbility<span class="token operator">&gt;</span> AbilityClass<span class="token punctuation">,</span> int32 Level <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> int32 InputID <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="'+c+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>',3),g=(0,t.Fv)('<figure><img src="'+l+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><ol><li><strong>能力激活</strong></li></ol><ul><li><strong>激活请求</strong>: 玩家或游戏逻辑触发能力的激活，通常通过调用 <code>ActivateAbility</code> 方法。</li><li><strong>能力检查</strong>: 通过 <code>CommitAbility</code> 方法检查能否激活能力（例如，检查能量、状态等）。</li></ul><ol start="2"><li><strong>能力执行</strong></li></ol><ul><li><strong>任务创建</strong>: 在能力中，可以创建和启动任务（如 <code>AbilityTask</code>），这些任务可以处理异步操作或延时执行。</li><li><strong>任务激活</strong>: 任务的 <code>Activate</code> 方法被调用，任务开始运行。</li></ul><ol start="3"><li><strong>结果处理</strong></li></ol><ul><li><strong>结束能力</strong>: 一旦完成所有操作，调用 <code>EndAbility</code> 方法结束能力的执行，并处理可能的状态更新。</li></ul><div class="language-cpp line-numbers-mode" data-ext="cpp" data-title="cpp"><pre class="language-cpp"><code>\t<span class="token comment">/** \n\t * Attempts to activate the given ability, will check costs and requirements before doing so.\n\t * Returns true if it thinks it activated, but it may return false positives due to failure later in activation.\n\t * If bAllowRemoteActivation is true, it will remotely activate local/server abilities, if false it will only try to locally activate the ability\n\t */</span>\n\t<span class="token function">UFUNCTION</span><span class="token punctuation">(</span>BlueprintCallable<span class="token punctuation">,</span> Category <span class="token operator">=</span> <span class="token string">&quot;Abilities&quot;</span><span class="token punctuation">)</span>\n\t<span class="token keyword">bool</span> <span class="token function">TryActivateAbility</span><span class="token punctuation">(</span>FGameplayAbilitySpecHandle AbilityToActivate<span class="token punctuation">,</span> <span class="token keyword">bool</span> bAllowRemoteActivation <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',8),A=(0,t.Lk)("figure",null,[(0,t.Lk)("img",{src:p,alt:"",tabindex:"0",loading:"lazy"}),(0,t.Lk)("figcaption")],-1),f=(0,t.Lk)("figure",null,[(0,t.Lk)("img",{src:k,alt:"",tabindex:"0",loading:"lazy"}),(0,t.Lk)("figcaption")],-1),h=(0,t.Lk)("h2",{id:"实践1-闪避",tabindex:"-1"},[(0,t.Lk)("a",{class:"header-anchor",href:"#实践1-闪避"},[(0,t.Lk)("span",null,"实践1|闪避")])],-1),T=(0,t.Lk)("h3",{id:"_1-abilitytask-waitgameplayevent",tabindex:"-1"},[(0,t.Lk)("a",{class:"header-anchor",href:"#_1-abilitytask-waitgameplayevent"},[(0,t.Lk)("span",null,"1.AbilityTask_WaitGameplayEvent")])],-1),D=(0,t.Lk)("figure",null,[(0,t.Lk)("img",{src:u,alt:"",tabindex:"0",loading:"lazy"}),(0,t.Lk)("figcaption")],-1),w=(0,t.Lk)("h3",{id:"_2-sendgameplayeventtoactor",tabindex:"-1"},[(0,t.Lk)("a",{class:"header-anchor",href:"#_2-sendgameplayeventtoactor"},[(0,t.Lk)("span",null,"2.SendGameplayEventToActor")])],-1),G=(0,t.Fv)('<h3 id="方向计算" tabindex="-1"><a class="header-anchor" href="#方向计算"><span>方向计算</span></a></h3><div class="language-cpp line-numbers-mode" data-ext="cpp" data-title="cpp"><pre class="language-cpp"><code>EDirectionType <span class="token class-name">UAbilityUtility</span><span class="token double-colon punctuation">::</span><span class="token function">DeterminePlayerInputDirection</span><span class="token punctuation">(</span><span class="token keyword">const</span> APawn<span class="token operator">*</span> Pawn<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n\t<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>Pawn <span class="token operator">||</span><span class="token operator">!</span>Pawn<span class="token operator">-&gt;</span>InputComponent<span class="token punctuation">)</span> <span class="token keyword">return</span> EDirectionType<span class="token double-colon punctuation">::</span>Invalid<span class="token punctuation">;</span>\n\t\n\t<span class="token comment">// 计算相对方向向量</span>\n\t<span class="token keyword">const</span> FVector InputDirection <span class="token operator">=</span> Pawn<span class="token operator">-&gt;</span><span class="token function">GetLastMovementInputVector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetSafeNormal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\t\n\t<span class="token keyword">if</span> <span class="token punctuation">(</span>InputDirection<span class="token punctuation">.</span><span class="token function">IsNearlyZero</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n\t<span class="token punctuation">{</span>\n\t\t<span class="token keyword">return</span> EDirectionType<span class="token double-colon punctuation">::</span>Forward<span class="token punctuation">;</span> <span class="token comment">// 默认向前</span>\n\t<span class="token punctuation">}</span>\n\t<span class="token keyword">float</span> ForwardDot <span class="token operator">=</span> <span class="token class-name">FVector</span><span class="token double-colon punctuation">::</span><span class="token function">DotProduct</span><span class="token punctuation">(</span>InputDirection<span class="token punctuation">,</span> Pawn<span class="token operator">-&gt;</span><span class="token function">GetActorForwardVector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\t<span class="token keyword">float</span> RightDot <span class="token operator">=</span> <span class="token class-name">FVector</span><span class="token double-colon punctuation">::</span><span class="token function">DotProduct</span><span class="token punctuation">(</span>InputDirection<span class="token punctuation">,</span> Pawn<span class="token operator">-&gt;</span><span class="token function">GetActorRightVector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n\t<span class="token keyword">if</span> <span class="token punctuation">(</span>ForwardDot <span class="token operator">&gt;</span> <span class="token number">0.5f</span><span class="token punctuation">)</span>\n\t<span class="token punctuation">{</span>\n\t\t<span class="token keyword">return</span> EDirectionType<span class="token double-colon punctuation">::</span>Forward<span class="token punctuation">;</span>\n\t<span class="token punctuation">}</span>\n\t<span class="token keyword">if</span> <span class="token punctuation">(</span>ForwardDot <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">)</span>\n\t<span class="token punctuation">{</span>\n\t\t<span class="token keyword">return</span> EDirectionType<span class="token double-colon punctuation">::</span>Backward<span class="token punctuation">;</span>\n\t<span class="token punctuation">}</span>\n\t<span class="token keyword">if</span> <span class="token punctuation">(</span>RightDot <span class="token operator">&gt;</span> <span class="token number">0.5f</span><span class="token punctuation">)</span>\n\t<span class="token punctuation">{</span>\n\t\t<span class="token keyword">return</span> EDirectionType<span class="token double-colon punctuation">::</span>Right<span class="token punctuation">;</span>\n\t<span class="token punctuation">}</span>\n\t<span class="token keyword">if</span> <span class="token punctuation">(</span>RightDot <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">0.5f</span><span class="token punctuation">)</span>\n\t<span class="token punctuation">{</span>\n\t\t<span class="token keyword">return</span> EDirectionType<span class="token double-colon punctuation">::</span>Left<span class="token punctuation">;</span>\n\t<span class="token punctuation">}</span>\n\t<span class="token keyword">return</span> EDirectionType<span class="token double-colon punctuation">::</span>Forward<span class="token punctuation">;</span> \n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><figure><img src="'+r+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure>',3),S={class:"hint-container note"},C=(0,t.Lk)("p",{class:"hint-container-title"},"注",-1),_=(0,t.Lk)("h3",{id:"abilitytasks",tabindex:"-1"},[(0,t.Lk)("a",{class:"header-anchor",href:"#abilitytasks"},[(0,t.Lk)("span",null,"AbilityTasks")])],-1),F=(0,t.Lk)("div",{class:"language-cpp line-numbers-mode","data-ext":"cpp","data-title":"cpp"},[(0,t.Lk)("pre",{class:"language-cpp"},[(0,t.Lk)("code",null,[(0,t.Lk)("span",{class:"token macro property"},[(0,t.Lk)("span",{class:"token directive-hash"},"#"),(0,t.Lk)("span",{class:"token directive keyword"},"include"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'"AbilitySystem/AbilityTasks/AbilityTask_CalculateInputDirection.h"')]),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token macro property"},[(0,t.Lk)("span",{class:"token directive-hash"},"#"),(0,t.Lk)("span",{class:"token directive keyword"},"include"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'"AbilitySystemComponent.h"')]),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token macro property"},[(0,t.Lk)("span",{class:"token directive-hash"},"#"),(0,t.Lk)("span",{class:"token directive keyword"},"include"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'"AbilitySystem/AbilityLib/EDirectionType.h"')]),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token macro property"},[(0,t.Lk)("span",{class:"token directive-hash"},"#"),(0,t.Lk)("span",{class:"token directive keyword"},"include"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'"AbilitySystem/AbilityLib/AbilityUtility.h"')]),(0,t.eW)("\n\nUAbilityTask_CalculateInputDirection"),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)(),(0,t.Lk)("span",{class:"token class-name"},"UAbilityTask_CalculateInputDirection"),(0,t.Lk)("span",{class:"token double-colon punctuation"},"::"),(0,t.Lk)("span",{class:"token function"},"CreateCalculateInputDirectionTask"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("UGameplayAbility"),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)(" OwningAbility"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n    UAbilityTask_CalculateInputDirection"),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)(" MyTask "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token generic-function"},[(0,t.Lk)("span",{class:"token function"},"NewAbilityTask"),(0,t.Lk)("span",{class:"token generic class-name"},[(0,t.Lk)("span",{class:"token operator"},"<"),(0,t.eW)("UAbilityTask_CalculateInputDirection"),(0,t.Lk)("span",{class:"token operator"},">")])]),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("OwningAbility"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(" MyTask"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n"),(0,t.Lk)("span",{class:"token keyword"},"void"),(0,t.eW)(),(0,t.Lk)("span",{class:"token class-name"},"UAbilityTask_CalculateInputDirection"),(0,t.Lk)("span",{class:"token double-colon punctuation"},"::"),(0,t.Lk)("span",{class:"token function"},"Activate"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token class-name"},"Super"),(0,t.Lk)("span",{class:"token double-colon punctuation"},"::"),(0,t.Lk)("span",{class:"token function"},"Activate"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token keyword"},"const"),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"bool"),(0,t.eW)(" bIsLocallyControlled "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(" Ability"),(0,t.Lk)("span",{class:"token operator"},"->"),(0,t.Lk)("span",{class:"token function"},"GetCurrentActorInfo"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token operator"},"->"),(0,t.Lk)("span",{class:"token function"},"IsLocallyControlled"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n    \n    "),(0,t.Lk)("span",{class:"token comment"},"// 如果是本地控制，则发送预测请求"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("bIsLocallyControlled"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token function"},"SendActionDirectionToServer"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token keyword"},"else"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token keyword"},"const"),(0,t.eW)(" FGameplayAbilitySpecHandle SpecHandle "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"GetAbilitySpecHandle"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token keyword"},"const"),(0,t.eW)(" FPredictionKey ActivationPredictionKey "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"GetActivationPredictionKey"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n        AbilitySystemComponent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Get"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token operator"},"->"),(0,t.Lk)("span",{class:"token function"},"AbilityTargetDataSetDelegate"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("SpecHandle"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" ActivationPredictionKey"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"AddUObject"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token keyword"},"this"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},"&"),(0,t.eW)("UAbilityTask_CalculateInputDirection"),(0,t.Lk)("span",{class:"token double-colon punctuation"},"::"),(0,t.eW)("OnActionDirectionReplicated"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token keyword"},"const"),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"bool"),(0,t.eW)(" bCalledDelegate "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(" AbilitySystemComponent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Get"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token operator"},"->"),(0,t.Lk)("span",{class:"token function"},"CallReplicatedTargetDataDelegatesIfSet"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("SpecHandle"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" ActivationPredictionKey"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token operator"},"!"),(0,t.eW)("bCalledDelegate"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n            "),(0,t.Lk)("span",{class:"token function"},"SetWaitingOnRemotePlayerData"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n"),(0,t.Lk)("span",{class:"token keyword"},"void"),(0,t.eW)(),(0,t.Lk)("span",{class:"token class-name"},"UAbilityTask_CalculateInputDirection"),(0,t.Lk)("span",{class:"token double-colon punctuation"},"::"),(0,t.Lk)("span",{class:"token function"},"SendActionDirectionToServer"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token comment"},"// 使用预测窗口来封装客户端到服务器的预测机制"),(0,t.eW)("\n    FScopedPredictionWindow "),(0,t.Lk)("span",{class:"token function"},"ScopedPrediction"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("AbilitySystemComponent"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Get"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n\n    "),(0,t.Lk)("span",{class:"token keyword"},"const"),(0,t.eW)(" APawn"),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)(" Character "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token generic-function"},[(0,t.Lk)("span",{class:"token function"},"Cast"),(0,t.Lk)("span",{class:"token generic class-name"},[(0,t.Lk)("span",{class:"token operator"},"<"),(0,t.eW)("APawn"),(0,t.Lk)("span",{class:"token operator"},">")])]),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("Ability"),(0,t.Lk)("span",{class:"token operator"},"->"),(0,t.Lk)("span",{class:"token function"},"GetCurrentActorInfo"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token operator"},"->"),(0,t.eW)("AvatarActor"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Get"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token operator"},"!"),(0,t.eW)("Character"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token function"},"EndTask"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)(),(0,t.Lk)("span",{class:"token comment"},"// 如果角色无效，结束任务"),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n    \n    "),(0,t.Lk)("span",{class:"token comment"},"// 根据输入方向判断动作类型"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token keyword"},"const"),(0,t.eW)(" EDirectionType ActionDirection "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token class-name"},"UAbilityUtility"),(0,t.Lk)("span",{class:"token double-colon punctuation"},"::"),(0,t.Lk)("span",{class:"token function"},"DeterminePlayerInputDirection"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("Character"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n\t\n    "),(0,t.Lk)("span",{class:"token comment"},"// 封装方向枚举到一个简单的数据结构中进行传输"),(0,t.eW)("\n    FGameplayAbilityTargetDataHandle DataHandle"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n    FGameplayAbilityTargetData_SimpleEnum"),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)(" Data "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"new"),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"FGameplayAbilityTargetData_SimpleEnum"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n    Data"),(0,t.Lk)("span",{class:"token operator"},"->"),(0,t.eW)("EnumValue "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(" ActionDirection"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n    DataHandle"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Add"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("Data"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n\n    "),(0,t.Lk)("span",{class:"token comment"},"// 发送数据到服务器"),(0,t.eW)("\n    AbilitySystemComponent"),(0,t.Lk)("span",{class:"token operator"},"->"),(0,t.Lk)("span",{class:"token function"},"ServerSetReplicatedTargetData"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token function"},"GetAbilitySpecHandle"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token function"},"GetActivationPredictionKey"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n        DataHandle"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n        "),(0,t.Lk)("span",{class:"token function"},"FGameplayTag"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n        AbilitySystemComponent"),(0,t.Lk)("span",{class:"token operator"},"->"),(0,t.eW)("ScopedPredictionKey"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n    \n    "),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token function"},"ShouldBroadcastAbilityTaskDelegates"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n        ValidDirection"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Broadcast"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("ActionDirection"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n\n"),(0,t.Lk)("span",{class:"token keyword"},"void"),(0,t.eW)(),(0,t.Lk)("span",{class:"token class-name"},"UAbilityTask_CalculateInputDirection"),(0,t.Lk)("span",{class:"token double-colon punctuation"},"::"),(0,t.Lk)("span",{class:"token function"},"OnActionDirectionReplicated"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token keyword"},"const"),(0,t.eW)(" FGameplayAbilityTargetDataHandle"),(0,t.Lk)("span",{class:"token operator"},"&"),(0,t.eW)(" DataHandle"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" FGameplayTag ActivationTag"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n    "),(0,t.Lk)("span",{class:"token comment"},"// 提取枚举类型的方向"),(0,t.eW)("\n  AbilitySystemComponent"),(0,t.Lk)("span",{class:"token operator"},"->"),(0,t.Lk)("span",{class:"token function"},"ConsumeClientReplicatedTargetData"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token function"},"GetAbilitySpecHandle"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"GetActivationPredictionKey"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n  \t"),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token function"},"ShouldBroadcastAbilityTaskDelegates"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n  \t"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n  \t    "),(0,t.Lk)("span",{class:"token keyword"},"for"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token keyword"},"auto"),(0,t.eW)(" Data "),(0,t.Lk)("span",{class:"token operator"},":"),(0,t.eW)(" DataHandle"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.eW)("Data"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n  \t    "),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n  \t        "),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("Data"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n  \t        "),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n  \t        \tGEngine"),(0,t.Lk)("span",{class:"token operator"},"->"),(0,t.Lk)("span",{class:"token function"},"AddOnScreenDebugMessage"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token operator"},"-"),(0,t.Lk)("span",{class:"token number"},"1"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token number"},"5.0f"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" FColor"),(0,t.Lk)("span",{class:"token double-colon punctuation"},"::"),(0,t.eW)("Red"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"TEXT"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token string"},'"OnActionDirectionReplicated"'),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n  \t        \tFGameplayAbilityTargetData_SimpleEnum"),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)(" HitResultPtr "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token generic-function"},[(0,t.Lk)("span",{class:"token function"},"static_cast"),(0,t.eW)(),(0,t.Lk)("span",{class:"token generic class-name"},[(0,t.Lk)("span",{class:"token operator"},"<"),(0,t.eW)("FGameplayAbilityTargetData_SimpleEnum"),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.Lk)("span",{class:"token operator"},">")])]),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("Data"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Get"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n  \t            "),(0,t.Lk)("span",{class:"token keyword"},"if"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("HitResultPtr"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n  \t            "),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n  \t            \tValidDirection"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"Broadcast"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("HitResultPtr"),(0,t.Lk)("span",{class:"token operator"},"->"),(0,t.eW)("EnumValue"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n  \t            "),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n  \t        "),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n  \t    "),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n  \t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n")])]),(0,t.Lk)("div",{class:"line-numbers","aria-hidden":"true"},[(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"})])],-1),E=(0,t.Lk)("div",{class:"language-cpp line-numbers-mode","data-ext":"cpp","data-title":"cpp"},[(0,t.Lk)("pre",{class:"language-cpp"},[(0,t.Lk)("code",null,[(0,t.Lk)("span",{class:"token macro property"},[(0,t.Lk)("span",{class:"token directive-hash"},"#"),(0,t.Lk)("span",{class:"token directive keyword"},"pragma"),(0,t.eW)(),(0,t.Lk)("span",{class:"token expression"},"once")]),(0,t.eW)("\n\n"),(0,t.Lk)("span",{class:"token macro property"},[(0,t.Lk)("span",{class:"token directive-hash"},"#"),(0,t.Lk)("span",{class:"token directive keyword"},"include"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'"CoreMinimal.h"')]),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token macro property"},[(0,t.Lk)("span",{class:"token directive-hash"},"#"),(0,t.Lk)("span",{class:"token directive keyword"},"include"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'"Abilities/Tasks/AbilityTask.h"')]),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token macro property"},[(0,t.Lk)("span",{class:"token directive-hash"},"#"),(0,t.Lk)("span",{class:"token directive keyword"},"include"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'"AbilitySystem/AbilityLib/AbilityUtility.h"')]),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token macro property"},[(0,t.Lk)("span",{class:"token directive-hash"},"#"),(0,t.Lk)("span",{class:"token directive keyword"},"include"),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'"AbilityTask_CalculateInputDirection.generated.h"')]),(0,t.eW)("\n\n"),(0,t.Lk)("span",{class:"token comment"},"// 自定义结构用于传递简单的枚举值"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token function"},"USTRUCT"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("BlueprintType"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token keyword"},"struct"),(0,t.eW)(),(0,t.Lk)("span",{class:"token class-name"},"FGameplayAbilityTargetData_SimpleEnum"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},":"),(0,t.eW)(),(0,t.Lk)("span",{class:"token base-clause"},[(0,t.Lk)("span",{class:"token keyword"},"public"),(0,t.eW)(),(0,t.Lk)("span",{class:"token class-name"},"FGameplayAbilityTargetData")]),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token function"},"GENERATED_USTRUCT_BODY"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\n\t"),(0,t.Lk)("span",{class:"token comment"},"// 用于存储简单的枚举值 (例如方向类型)"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token function"},"UPROPERTY"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("BlueprintReadWrite"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" EditAnywhere"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" Category "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(" Targeting"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\tEDirectionType EnumValue"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n    \n\t"),(0,t.Lk)("span",{class:"token keyword"},"virtual"),(0,t.eW)(" UScriptStruct"),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"GetScriptStruct"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"const"),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"override"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(),(0,t.Lk)("span",{class:"token class-name"},"FGameplayAbilityTargetData_SimpleEnum"),(0,t.Lk)("span",{class:"token double-colon punctuation"},"::"),(0,t.Lk)("span",{class:"token function"},"StaticStruct"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n\t"),(0,t.Lk)("span",{class:"token keyword"},"virtual"),(0,t.eW)(" FString "),(0,t.Lk)("span",{class:"token function"},"ToString"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"const"),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"override"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(),(0,t.Lk)("span",{class:"token class-name"},"FString"),(0,t.Lk)("span",{class:"token double-colon punctuation"},"::"),(0,t.Lk)("span",{class:"token function"},"Printf"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token function"},"TEXT"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token string"},'"EnumValue: %d"'),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token generic-function"},[(0,t.Lk)("span",{class:"token function"},"static_cast"),(0,t.Lk)("span",{class:"token generic class-name"},[(0,t.Lk)("span",{class:"token operator"},"<"),(0,t.eW)("uint8"),(0,t.Lk)("span",{class:"token operator"},">")])]),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("EnumValue"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n\n\t"),(0,t.Lk)("span",{class:"token keyword"},"bool"),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"NetSerialize"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("FArchive"),(0,t.Lk)("span",{class:"token operator"},"&"),(0,t.eW)(" Ar"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" UPackageMap"),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)(" Map"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"bool"),(0,t.Lk)("span",{class:"token operator"},"&"),(0,t.eW)(" bOutSuccess"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token comment"},"//Ar << EnumValue; // 序列化 EnumValue"),(0,t.eW)("\n\t\tAr"),(0,t.Lk)("span",{class:"token punctuation"},"."),(0,t.Lk)("span",{class:"token function"},"SerializeBits"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token operator"},"&"),(0,t.eW)("EnumValue"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(),(0,t.Lk)("span",{class:"token number"},"3"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n\t\tbOutSuccess "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"true"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n\t\t"),(0,t.Lk)("span",{class:"token keyword"},"return"),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"true"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n\n"),(0,t.Lk)("span",{class:"token comment"},"// 使结构可以通过网络序列化"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token keyword"},"template"),(0,t.Lk)("span",{class:"token operator"},"<"),(0,t.Lk)("span",{class:"token operator"},">"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token keyword"},"struct"),(0,t.eW)(),(0,t.Lk)("span",{class:"token class-name"},"TStructOpsTypeTraits"),(0,t.Lk)("span",{class:"token operator"},"<"),(0,t.eW)("FGameplayAbilityTargetData_SimpleEnum"),(0,t.Lk)("span",{class:"token operator"},">"),(0,t.eW)(),(0,t.Lk)("span",{class:"token operator"},":"),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"public"),(0,t.eW)(" TStructOpsTypeTraitsBase2"),(0,t.Lk)("span",{class:"token operator"},"<"),(0,t.eW)("FGameplayAbilityTargetData_SimpleEnum"),(0,t.Lk)("span",{class:"token operator"},">"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"enum"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t\tWithNetSerializer "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token boolean"},"true"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n\n"),(0,t.Lk)("span",{class:"token function"},"UCLASS"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token keyword"},"class"),(0,t.eW)(),(0,t.Lk)("span",{class:"token class-name"},"EXORCIST_API"),(0,t.eW)(" UAbilityTask_CalculateInputDirection "),(0,t.Lk)("span",{class:"token operator"},":"),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"public"),(0,t.eW)(" UAbilityTask\n"),(0,t.Lk)("span",{class:"token punctuation"},"{"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token function"},"GENERATED_BODY"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n"),(0,t.Lk)("span",{class:"token keyword"},"public"),(0,t.Lk)("span",{class:"token operator"},":"),(0,t.eW)("\n\n\t"),(0,t.Lk)("span",{class:"token function"},"DECLARE_DYNAMIC_MULTICAST_DELEGATE_OneParam"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("FInputDirectionDelegate"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" EDirectionType"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" DirectionType"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n\t\n\t"),(0,t.Lk)("span",{class:"token function"},"UFUNCTION"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("BlueprintCallable"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" Category"),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.Lk)("span",{class:"token string"},'"Ability|Tasks"'),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" meta "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("DisplayName "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'"CreateGetInputDirectionTask"'),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" HidePin "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'"OwningAbility"'),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" DefaultToSelf "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'"OwningAbility"'),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" BlueprintInternalUseOnly "),(0,t.Lk)("span",{class:"token operator"},"="),(0,t.eW)(),(0,t.Lk)("span",{class:"token string"},'"true"'),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"static"),(0,t.eW)(" \tUAbilityTask_CalculateInputDirection"),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"CreateCalculateInputDirectionTask"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("UGameplayAbility"),(0,t.Lk)("span",{class:"token operator"},"*"),(0,t.eW)(" OwningAbility"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n\n\t"),(0,t.Lk)("span",{class:"token function"},"UPROPERTY"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.eW)("BlueprintAssignable"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\tFInputDirectionDelegate ValidDirection"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n\n"),(0,t.Lk)("span",{class:"token keyword"},"private"),(0,t.Lk)("span",{class:"token operator"},":"),(0,t.eW)("\n\n\t"),(0,t.Lk)("span",{class:"token keyword"},"virtual"),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"void"),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"Activate"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)(),(0,t.Lk)("span",{class:"token keyword"},"override"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n\t\n\t"),(0,t.Lk)("span",{class:"token function"},"UFUNCTION"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"void"),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"SendActionDirectionToServer"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n\t\n\t"),(0,t.Lk)("span",{class:"token function"},"UFUNCTION"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.eW)("\n\t"),(0,t.Lk)("span",{class:"token keyword"},"void"),(0,t.eW)(),(0,t.Lk)("span",{class:"token function"},"OnActionDirectionReplicated"),(0,t.Lk)("span",{class:"token punctuation"},"("),(0,t.Lk)("span",{class:"token keyword"},"const"),(0,t.eW)(" FGameplayAbilityTargetDataHandle"),(0,t.Lk)("span",{class:"token operator"},"&"),(0,t.eW)(" DataHandle"),(0,t.Lk)("span",{class:"token punctuation"},","),(0,t.eW)(" FGameplayTag ActivationTag"),(0,t.Lk)("span",{class:"token punctuation"},")"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n\t\n"),(0,t.Lk)("span",{class:"token punctuation"},"}"),(0,t.Lk)("span",{class:"token punctuation"},";"),(0,t.eW)("\n")])]),(0,t.Lk)("div",{class:"line-numbers","aria-hidden":"true"},[(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"}),(0,t.Lk)("div",{class:"line-number"})])],-1),I=(0,t.Lk)("h3",{id:"实例化策略",tabindex:"-1"},[(0,t.Lk)("a",{class:"header-anchor",href:"#实例化策略"},[(0,t.Lk)("span",null,"实例化策略")])],-1),U=(0,t.Fv)('<figure><img src="'+L+'" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><table><thead><tr><th>实例化类型</th><th>描述</th><th>优点</th><th>适用场景</th></tr></thead><tbody><tr><td><strong>按执行实例化</strong></td><td>每次技能运行时生成新对象副本。</td><td>可自由使用蓝图和成员变量，所有内容在执行前初始化。</td><td>不频繁运行的技能，例如MOBA中的&quot;终极技能&quot;。</td></tr><tr><td><strong>按Actor实例化</strong></td><td>每个Actor在首次执行时生成技能实例，以后复用。</td><td>减少新对象创建的开销，适合大规模使用技能。</td><td>大型战斗中频繁使用的技能，例如小兵的基本攻击。</td></tr><tr><td><strong>非实例化</strong></td><td>使用类默认对象，不生成任何新实例。</td><td>效率最高，无需创建对象，节省资源。</td><td>高频率执行且不需内部变量的技能，例如RTS中的基本攻击。</td></tr></tbody></table>',2),P={},R=(0,s(66262).A)(P,[["render",function(n,a){const s=(0,t.g2)("chatmessage"),e=(0,t.g2)("RouteLink"),o=(0,t.g2)("CodeTabs");return(0,t.uX)(),(0,t.CE)("div",null,[d,(0,t.bF)(s,{avatar:"../../assets/emoji/bqb (2).png",avatarWidth:40,alignLeft:""},{default:(0,t.k6)((()=>[(0,t.eW)(" GameplayAbility 技能类，是对技能的抽象，后文用GA简称，ASC则是 AbilitySystemComponent 的简写 ")])),_:1}),b,(0,t.bF)(s,{avatar:"../../assets/emoji/bqb (2).png",avatarWidth:40,alignLeft:""},{default:(0,t.k6)((()=>[(0,t.eW)(" 服务端具有权威性，所有角色都持有技能 ")])),_:1}),m,(0,t.bF)(s,{avatar:"../../assets/emoji/bqb (2).png",avatarWidth:40,alignLeft:""},{default:(0,t.k6)((()=>[(0,t.eW)(" 客户端则本地玩家控制的角色中持有 ")])),_:1}),v,y,(0,t.bF)(s,{avatar:"../../assets/emoji/hx.png",avatarWidth:40},{default:(0,t.k6)((()=>[(0,t.eW)(" 怎么给我的角色设定技能呢？ ")])),_:1}),(0,t.bF)(s,{avatar:"../../assets/emoji/bqb (2).png",avatarWidth:40,alignLeft:""},{default:(0,t.k6)((()=>[(0,t.eW)(" GA本身受ASC组件维护，所以可以通过ASC本身授权、激活,激活操作则在服务器上执行。 ")])),_:1}),W,(0,t.bF)(s,{avatar:"../../assets/emoji/bqb (2).png",avatarWidth:40,alignLeft:""},{default:(0,t.k6)((()=>[(0,t.eW)(" 下面是GA的基本流程 ")])),_:1}),g,(0,t.bF)(s,{avatar:"../../assets/emoji/bqb (2).png",avatarWidth:40,alignLeft:""},{default:(0,t.k6)((()=>[(0,t.eW)(" GA本身，可以通过持有的ActorInfo来获取外部信息。就像下面这样 ")])),_:1}),A,(0,t.bF)(s,{avatar:"../../assets/emoji/bqb (2).png",avatarWidth:40,alignLeft:""},{default:(0,t.k6)((()=>[(0,t.eW)(" 如果想把跳跃封装成GA，可以用类似下面的方法。 ")])),_:1}),f,h,(0,t.bF)(s,{avatar:"../../assets/emoji/bqb (2).png",avatarWidth:40,alignLeft:""},{default:(0,t.k6)((()=>[(0,t.eW)(" 在这之前我们需要了解几个传递数据给GA的方法。 ")])),_:1}),T,(0,t.bF)(s,{avatar:"../../assets/emoji/bqb (2).png",avatarWidth:40,alignLeft:""},{default:(0,t.k6)((()=>[(0,t.eW)(" GA不仅仅可以通过ASC->TryActivateAbility执行，还可以通过事件触发， ")])),_:1}),D,w,(0,t.bF)(s,{avatar:"../../assets/emoji/hx.png",avatarWidth:40},{default:(0,t.k6)((()=>[(0,t.eW)(" 也就是说我可以通过这个SendGameplayEventToActor 激活拥有Tag的事件？比如翻滚闪避动作？ 外部判断闪避方向传递闪避方向给这个GA? ")])),_:1}),(0,t.bF)(s,{avatar:"../../assets/emoji/bqb (2).png",avatarWidth:40,alignLeft:""},{default:(0,t.k6)((()=>[(0,t.eW)(" 是的，只不过你说的这种其实完全可以在GA中实现，通过事件传递更适合类似受击技能，通过Hit等伤害事件触发传递的。 ")])),_:1}),(0,t.bF)(s,{avatar:"../../assets/emoji/hx.png",avatarWidth:40},{default:(0,t.k6)((()=>[(0,t.eW)(" 为什么？ ")])),_:1}),(0,t.bF)(s,{avatar:"../../assets/emoji/bqb (2).png",avatarWidth:40,alignLeft:""},{default:(0,t.k6)((()=>[(0,t.eW)(" 受击本身就是通过伤害碰撞事件传递的，事件本身是服务器行为，所以受击行为很好做，只需要通过伤害事件配合方向计算就行了。 但闪避则不同，闪避的基本思路是根据是客户端的前一帧输入方向，通过服务器授权播放对应的方向。（本地会预测播放） ")])),_:1}),G,(0,t.Lk)("div",S,[C,(0,t.Lk)("p",null,[(0,t.eW)("扩展- GetLastInputVector 和 GetLastMovementInputVector区别"),(0,t.bF)(e,{to:"/unreal/exp_%E7%BB%8F%E9%AA%8C_/10-inputvector.html"},{default:(0,t.k6)((()=>[(0,t.eW)("传送门")])),_:1})])]),(0,t.bF)(s,{avatar:"../../assets/emoji/hx.png",avatarWidth:40},{default:(0,t.k6)((()=>[(0,t.eW)(" 也就是说，闪避需要RPC提交给服务器执行？本地客户端可以拿到对应的Input方向，但对应在服务器上的角色 好像并不会监听客户端的输入方向。 ")])),_:1}),(0,t.bF)(s,{avatar:"../../assets/emoji/bqb (2).png",avatarWidth:40,alignLeft:""},{default:(0,t.k6)((()=>[(0,t.eW)(" RPC肯定是要的，咱完全可以封装封装在GA中，利用GAS的框架函数来实现。 ")])),_:1}),(0,t.bF)(s,{avatar:"../../assets/emoji/hx.png",avatarWidth:40},{default:(0,t.k6)((()=>[(0,t.eW)(" 可是GA中执行GetLastInputVector服务器端一样拿不到结果啊！GA本身并不是Actor，也没法发起RPC吧？ ")])),_:1}),(0,t.bF)(s,{avatar:"../../assets/emoji/bqb (2).png",avatarWidth:40,alignLeft:""},{default:(0,t.k6)((()=>[(0,t.eW)(" GA本身确实不可以，但你别忘记GA是由ASC组件维护的，自然可以通过ASC来同步一些变量。并且这种任务多半是异步任务，我们可以封装在AbilityTasks中, 例如：我想同步一个方向枚举给服务器，以便能够正确的播放对应的动画。 ")])),_:1}),_,(0,t.bF)(o,{id:"129",data:[{id:"UAbilityTask_CalculateInputDirection.cpp"},{id:"AbilityTask_CalculateInputDirection.h"}],"tab-id":"language"},{title0:(0,t.k6)((({value:n,isActive:a})=>[(0,t.eW)("UAbilityTask_CalculateInputDirection.cpp")])),title1:(0,t.k6)((({value:n,isActive:a})=>[(0,t.eW)("AbilityTask_CalculateInputDirection.h")])),tab0:(0,t.k6)((({value:n,isActive:a})=>[F])),tab1:(0,t.k6)((({value:n,isActive:a})=>[E])),_:1},8,["data"]),I,(0,t.bF)(s,{avatar:"../../assets/emoji/bqb (2).png",avatarWidth:40,alignLeft:""},{default:(0,t.k6)((()=>[(0,t.eW)(" 不同的实例化策略，对数据的保存能力也不同 ")])),_:1}),U])}]]),O=JSON.parse('{"path":"/unreal/core_%E6%A0%B8%E5%BF%83_/8.2-GASAbility.html","title":"c8.1GAS|GameplayAbility实践-翻滚、受击","lang":"zh-CN","frontmatter":{"title":"c8.1GAS|GameplayAbility实践-翻滚、受击","order":801,"category":["u++"],"description":"回顾 网络权限 GiveAbility 能力激活 激活请求: 玩家或游戏逻辑触发能力的激活，通常通过调用 ActivateAbility 方法。 能力检查: 通过 CommitAbility 方法检查能否激活能力（例如，检查能量、状态等）。 能力执行 任务创建: 在能力中，可以创建和启动任务（如 AbilityTask），这些任务可以处理异步操作或延时...","head":[["meta",{"property":"og:url","content":"https://rendertool.github.io/RenderDoc/RenderDoc/unreal/core_%E6%A0%B8%E5%BF%83_/8.2-GASAbility.html"}],["meta",{"property":"og:site_name","content":"RenderDoc"}],["meta",{"property":"og:title","content":"c8.1GAS|GameplayAbility实践-翻滚、受击"}],["meta",{"property":"og:description","content":"回顾 网络权限 GiveAbility 能力激活 激活请求: 玩家或游戏逻辑触发能力的激活，通常通过调用 ActivateAbility 方法。 能力检查: 通过 CommitAbility 方法检查能否激活能力（例如，检查能量、状态等）。 能力执行 任务创建: 在能力中，可以创建和启动任务（如 AbilityTask），这些任务可以处理异步操作或延时..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-10-25T23:34:33.000Z"}],["meta",{"property":"article:author","content":"Mr.Si"}],["meta",{"property":"article:modified_time","content":"2024-10-25T23:34:33.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"c8.1GAS|GameplayAbility实践-翻滚、受击\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2024-10-25T23:34:33.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mr.Si\\",\\"url\\":\\"https://rendertool.github.io/RenderDoc/\\"}]}"]]},"headers":[{"level":2,"title":"回顾","slug":"回顾","link":"#回顾","children":[{"level":3,"title":"网络权限","slug":"网络权限","link":"#网络权限","children":[]},{"level":3,"title":"GiveAbility","slug":"giveability","link":"#giveability","children":[]}]},{"level":2,"title":"实践1|闪避","slug":"实践1-闪避","link":"#实践1-闪避","children":[{"level":3,"title":"1.AbilityTask_WaitGameplayEvent","slug":"_1-abilitytask-waitgameplayevent","link":"#_1-abilitytask-waitgameplayevent","children":[]},{"level":3,"title":"2.SendGameplayEventToActor","slug":"_2-sendgameplayeventtoactor","link":"#_2-sendgameplayeventtoactor","children":[]},{"level":3,"title":"方向计算","slug":"方向计算","link":"#方向计算","children":[]},{"level":3,"title":"AbilityTasks","slug":"abilitytasks","link":"#abilitytasks","children":[]},{"level":3,"title":"实例化策略","slug":"实例化策略","link":"#实例化策略","children":[]}]}],"git":{"createdTime":1729899273000,"updatedTime":1729899273000,"contributors":[{"name":"sigaohe","email":"750831855@qq.com","commits":1}]},"readingTime":{"minutes":6.07,"words":1820},"filePathRelative":"unreal/core[核心]/8.2-GASAbility.md","localizedDate":"2024年10月25日","excerpt":"<h2>回顾</h2>\\n\\n<h3>网络权限</h3>\\n\\n<figure><figcaption></figcaption></figure>\\n\\n<figure><figcaption></figcaption></figure>\\n<h3>GiveAbility</h3>\\n\\n\\n<figure><figcaption></figcaption></figure>\\n<div class=\\"language-cpp\\" data-ext=\\"cpp\\" data-title=\\"cpp\\"><pre class=\\"language-cpp\\"><code>\\t<span class=\\"token function\\">UFUNCTION</span><span class=\\"token punctuation\\">(</span>BlueprintCallable<span class=\\"token punctuation\\">,</span> BlueprintAuthorityOnly<span class=\\"token punctuation\\">,</span> Category <span class=\\"token operator\\">=</span> <span class=\\"token string\\">\\"Gameplay Abilities\\"</span><span class=\\"token punctuation\\">,</span> meta <span class=\\"token operator\\">=</span> <span class=\\"token punctuation\\">(</span>DisplayName <span class=\\"token operator\\">=</span> <span class=\\"token string\\">\\"Give Ability\\"</span><span class=\\"token punctuation\\">,</span> ScriptName <span class=\\"token operator\\">=</span> <span class=\\"token string\\">\\"GiveAbility\\"</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span>\\n\\tFGameplayAbilitySpecHandle <span class=\\"token function\\">K2_GiveAbility</span><span class=\\"token punctuation\\">(</span>TSubclassOf<span class=\\"token operator\\">&lt;</span>UGameplayAbility<span class=\\"token operator\\">&gt;</span> AbilityClass<span class=\\"token punctuation\\">,</span> int32 Level <span class=\\"token operator\\">=</span> <span class=\\"token number\\">0</span><span class=\\"token punctuation\\">,</span> int32 InputID <span class=\\"token operator\\">=</span> <span class=\\"token operator\\">-</span><span class=\\"token number\\">1</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n</code></pre></div>","autoDesc":true}')}}]);